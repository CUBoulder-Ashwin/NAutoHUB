{% extends "base.html" %}
{% block title %}IPAM - NAutoHUB{% endblock %}

{% block content %}
<div class="page-header">
  <h1 class="page-title">IP Address Management</h1>
  <p class="page-description">View and manage your network's IP address inventory</p>
</div>

<div class="table-container">
  <table class="table table-striped table-ipam">
    <thead>
      <tr>
        <th>Device Name</th>
        <th>Interface Name</th>
        <th>IP Address</th>
        <th>Subnet Mask</th>
      </tr>
    </thead>
    <tbody>
      {% set current_device = None %}
      {% for row in ipam_data %}
        {% set device_class = "device-" + row["Device Name"]|lower|replace(" ", "-") %}
        <tr class="{{ device_class }}" data-device="{{ device_class }}">
          {% if row.get("rowspan") %}
            <td rowspan="{{ row.rowspan }}" class="hostname">{{ row["Device Name"] }}</td>
          {% endif %}
          <td>{{ row["Interface Name"] }}</td>
          <td class="ip-address font-mono">{{ row["IP Address"] }}</td>
          <td class="font-mono">{{ row["Subnet Mask"] }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% if not ipam_data %}
<div class="empty-state">
  <div class="empty-state-icon">
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <ellipse cx="12" cy="5" rx="9" ry="3"/>
      <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
      <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
    </svg>
  </div>
  <h3 class="empty-state-title">No IP addresses found</h3>
  <p class="empty-state-description">Deploy a topology to populate the IPAM database</p>
</div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', () => {
  const rows = document.querySelectorAll('.table-ipam tbody tr');

  rows.forEach(row => {
    const deviceClass = row.dataset.device;
    if (!deviceClass) return;

    row.addEventListener('mouseenter', () => {
      document.querySelectorAll(`[data-device="${deviceClass}"]`).forEach(r => {
        r.style.backgroundColor = 'var(--color-primary-light)';
      });
    });

    row.addEventListener('mouseleave', () => {
      document.querySelectorAll(`[data-device="${deviceClass}"]`).forEach(r => {
        r.style.backgroundColor = '';
      });
    });
  });
});
</script>
{% endblock %}
